# 决策树——分类树

## 一、 信息熵和信息增益

### 信息熵

熵，在物理中表示一个体系混乱程度的度量，熵越高，混乱程度越高。

信息熵（<a href="https://www.codecogs.com/eqnedit.php?latex=Ent(D_A_i)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Ent(x)" title="Ent(D_A_i)" /></a> ）是一个系统有序化程度的度量。<a href="https://www.codecogs.com/eqnedit.php?latex=Ent(D_A_i)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Ent(x)" title="Ent(D_A_i)" /></a>越小，则某个样本集合中的元素纯度越高。

假如一个随机变量X取值为<a href="https://www.codecogs.com/eqnedit.php?latex=X=\left&space;\{&space;x_1,x_2,...,x_n&space;\right&space;\}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?X=\left&space;\{&space;x_1,x_2,...,x_n&space;\right&space;\}" title="X=\left \{ x_1,x_2,...,x_n \right \}" /></a>，每一种取到的概率分别为<a href="https://www.codecogs.com/eqnedit.php?latex=\left&space;\{&space;p_1,p_2,...,p_n&space;\right&space;\}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left&space;\{&space;p_1,p_2,...,p_n&space;\right&space;\}" title="\left \{ p_1,p_2,...,p_n \right \}" /></a>，那么X的信息熵的公式：<a href="https://www.codecogs.com/eqnedit.php?latex=H(X)=-\sum_{i=1}^{n}p_i\log_2p_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Ent(X)=-\sum_{i=1}^{n}p_i\log_2p_i" title="Ent(X)=-\sum_{i=1}^{n}p_i\log_2p_i" /></a>，单位：bit

### 信息增益

信息增益，是数据集<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>按照其中的某个特征<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_i" title="D" /></a>所进行划分之后，数据集<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>的纯度提升的度量。一般而言，信息增益越大，意味着使用<a href="https://www.codecogs.com/eqnedit.php?latex=A_{max}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_{i}" title="A_{max}" /></a>这个特征来划分数据集<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>所获得的的纯度提升越大。

一个数据集<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>，对于<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>的最终分类<a href="https://www.codecogs.com/eqnedit.php?latex=C=\left&space;\{&space;c_1,c_2,...,c_n&space;\right&space;\}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C=\left&space;\{&space;c_1,c_2,...,c_n&space;\right&space;\}" title="C=\left \{ c_1,c_2,...,c_n \right \}" /></a>，可以根据集合<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C" title="D" /></a>，计算数据集D的根节点信息熵<a href="https://www.codecogs.com/eqnedit.php?latex=Ent(D)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Ent(D)" title="Ent(D)" /></a>。

假设<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>包含多种特征<a href="https://www.codecogs.com/eqnedit.php?latex=A=\left&space;\{&space;a_1,a_2,...,a_n&space;\right&space;\}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A=\left&space;\{&space;A_1,A_2,...,A_n&space;\right&space;\}" title="A=\left \{ a_1,a_2,...,a_n \right \}" /></a>，对于每个特征<a href="https://www.codecogs.com/eqnedit.php?latex=A_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_i" title="a_i" /></a>，其又包含取值为<a href="https://www.codecogs.com/eqnedit.php?latex=\left\{a_1,a_2,...,a_n\right\}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left\{a_1,a_2,...,a_n\right\}" title="\left\{a_1,a_2,...,a_n\right\}" /></a>的离散值。设数据集在<a href="https://www.codecogs.com/eqnedit.php?latex=a_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?a_i" title="a_i" /></a>这个特征上的分类为<a href="https://www.codecogs.com/eqnedit.php?latex=D_a_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D_a_i" title="D_a_i" /></a>，那么特征<a href="https://www.codecogs.com/eqnedit.php?latex=A_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_i" title="A_i" /></a>的信息熵<a href="https://www.codecogs.com/eqnedit.php?latex=Ent(D_A_i)=-\sum_{v=a_1}^{a_n}\frac{\left&space;|&space;D_v&space;\right&space;|}{\left&space;|&space;D&space;\right&space;|}Ent(D_v)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Ent(D_A_i)=-\sum_{v=a_1}^{a_n}\frac{\left&space;|&space;D_v&space;\right&space;|}{\left&space;|&space;D&space;\right&space;|}Ent(D_v)" title="Ent(D_A_i)=-\sum_{v=a_1}^{a_n}\frac{\left | D_v \right |}{\left | D \right |}Ent(D_v)" /></a>。

所以，对于每个特征<a href="https://www.codecogs.com/eqnedit.php?latex=A_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_i" title="A_i" /></a>，可以求得特征<a href="https://www.codecogs.com/eqnedit.php?latex=A_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_i" title="A_i" /></a>对样本集<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>进行划分所获得的**信息增益**：

<a href="https://www.codecogs.com/eqnedit.php?latex=Gain(D,A_i)=Ent(D)-\sum_{v=a_i}^{a_n}\frac{\left&space;|&space;D_v&space;\right&space;|}{\left&space;|&space;D&space;\right&space;|}Ent(D_v)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Gain(D,A_i)=Ent(D)-\sum_{v=a_i}^{a_n}\frac{\left&space;|&space;D_v&space;\right&space;|}{\left&space;|&space;D&space;\right&space;|}Ent(D_v)" title="Gain(D,A_i)=Ent(D)-\sum_{v=a_i}^{a_n}\frac{\left | D_v \right |}{\left | D \right |}Ent(D_v)" /></a>

通过比较每个<a href="https://www.codecogs.com/eqnedit.php?latex=Gain(D,A_i)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Gain(D,A_i)" title="Gain(D,A_i)" /></a>，<a href="https://www.codecogs.com/eqnedit.php?latex=i\in&space;\left&space;[&space;1,n\right&space;]" target="_blank"><img src="https://latex.codecogs.com/gif.latex?i\in&space;\left&space;[&space;1,n\right&space;]" title="i\in \left [ 1,n\right ]" /></a>，取使<a href="https://www.codecogs.com/eqnedit.php?latex=Gain" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Gain" title="Gain" /></a>最大的特征<a href="https://www.codecogs.com/eqnedit.php?latex=A_{max}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_{max}" title="A_{max}" /></a>。则意味着，使用<a href="https://www.codecogs.com/eqnedit.php?latex=A_{max}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_{max}" title="A_{max}" /></a>这个特征来划分数据集<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>所获得的的*纯度提升*最大。

#### 小结求信息增益的步骤：

1. 求数据集<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>的根节点信息熵 <a href="https://www.codecogs.com/eqnedit.php?latex=Ent(D)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Ent(D)" title="Ent(D)" /></a>。

2. 求每个特征<a href="https://www.codecogs.com/eqnedit.php?latex=A_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_i" title="A_i" /></a>的信息熵 <a href="https://www.codecogs.com/eqnedit.php?latex=Ent(D_A_i)=-\sum_{v=a_1}^{a_n}\frac{\left&space;|&space;D_v&space;\right&space;|}{\left&space;|&space;D&space;\right&space;|}Ent(D_v)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Ent(D_A_i)=-\sum_{v=a_1}^{a_n}\frac{\left&space;|&space;D_v&space;\right&space;|}{\left&space;|&space;D&space;\right&space;|}Ent(D_v)" title="Ent(D_A_i)=-\sum_{v=a_1}^{a_n}\frac{\left | D_v \right |}{\left | D \right |}Ent(D_v)" /></a>。

3. 求每个特征<a href="https://www.codecogs.com/eqnedit.php?latex=A_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_i" title="A_i" /></a>对样本集<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="D" /></a>进行划分所获得的**信息增益**：<a href="https://www.codecogs.com/eqnedit.php?latex=Gain(D,A_i)=Ent(D)-\sum_{v=a_i}^{a_n}\frac{\left&space;|&space;D_v&space;\right&space;|}{\left&space;|&space;D&space;\right&space;|}Ent(D_v)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Gain(D,A_i)=Ent(D)-\sum_{v=a_i}^{a_n}\frac{\left&space;|&space;D_v&space;\right&space;|}{\left&space;|&space;D&space;\right&space;|}Ent(D_v)" title="Gain(D,A_i)=Ent(D)-\sum_{v=a_i}^{a_n}\frac{\left | D_v \right |}{\left | D \right |}Ent(D_v)" /></a>

4. 按照最大信息增益的特征<a href="https://www.codecogs.com/eqnedit.php?latex=A_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A_i" title="A_i" /></a>对数据集特征<a href="https://www.codecogs.com/eqnedit.php?latex=D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D" title="A_i" /></a>进行划分

   



